question 1 ::::select distinct students.id,courses.course_name, concat(ifnull(students.first_name,' '),ifnull(students.middle_name,' '),ifnull(students.last_name,' ')) as student_name, batches.id ,group_concat(distinct subjects.name order by subjects.name separator ',') as subjects from students inner join batches on students.batch_id=batches.id left outer join subjects on batches.id=subjects.batch_id inner join courses on batches.course_id=courses.id where courses.is_deleted=0 and students.school_id=83 and students.is_active=1 and batches.is_active=1 group by students.id order by students.id asc ;

question 2 :::select students.first_name, subject_leaves.subject_id, count(*) as subject_leaves from students inner join subject_leaves on students.id=subject_leaves.student_id where students.school_id=83 group by students.id;


question 3::::select students.id, concat(students.first_name,'  ',students.middle_name,'  ',students.last_name) as student_name,dayname(month_date) as absent_day,month_date as date,group_concat(employees.first_name,'  ',employees.middle_name,'  ',employees.last_name separator ',') as absent_marked_by from students inner join subject_leaves on students.id = subject_leaves.student_id inner join subject_leaves_teachers on subject_leaves.id=subject_leaves_teachers.subject_leave_id inner join employees on subject_leaves_teachers.employee_id=employees.id where subject_leaves.school_id=83 group by subject_leave_id ;

question 4 :::select concat_ws(students.first_name,' ',middle_name,' ',last_name) AS NAME from students inner join finance_fees on students.id=finance_fees.student_id inner join finance_fee_collections on finance_fees.fee_collection_id=finance_fee_collections.id inner join fines on finance_fee_collections.fine_id=fines.id inner join fine_rules on fines.id=fine_rules.fine_id where concat_ws(students.first_name,' ' ,students.middle_name,' ',students.last_name) like '%aman%' and finance_fees.is_paid=0 group by students.id;


questio 5 :::
(old) : select students.first_name,student_id ,sum(discount_amount) from students inner join finance_fees on students.id=finance_fees.student_id inner join finance_fee_collections on finance_fees.fee_collection_id=finance_fee_collections.id inner join collection_discounts on finance_fee_collections.id=collection_discounts.finance_fee_collection_id inner join fee_discounts on collection_discounts.fee_discount_id=fee_discounts.id where students.school_id=83 group by students.id  having sum(discount_amount)>0;


(modified)  select students.first_name,group_concat(fee_discounts.name separator ','), sum(fee_discounts.discount) from students inner join finance_fees on students.id=finance_fees.student_id inner join finance_fee_collections on finance_fees.fee_collection_id=finance_fee_collections.id inner join collection_discounts on finance_fee_collections.id=collection_discounts.finance_fee_collection_id inner join fee_discounts on collection_discounts.fee_discount_id=fee_discounts.id where students.school_id=83 group by students.id;

question 6 :::select concat(students.first_name,' ',students.middle_name,' ',students.last_name) as students_name from students inner join finance_transactions on students.id=finance_transactions.payee_id where students.school_id=83 and finance_transactions.payment_mode='online payment' and payee_type='student' group by students.user_id;

question 7 :::select book_movements.user_id as stu_id_book_table, students.id,concat(students.first_name,' ',students.middle_name,' ',students.last_name) as students_name , book_movements.status,book_movements.due_date from students inner join book_movements on students.user_id=book_movements.user_id where (book_movements.status in ('issued','renewed') or curdate() > due_date) and book_movements.school_id=83 ;

question 8 :::select batch_tutors.employee_id as emp_no_in_batch_table,concat(first_name,' ',middle_name,' ',last_name) as employee_name from employees inner join batch_tutors on employees.id=batch_tutors.employee_id left join employee_attendances on batch_tutors.employee_id=employee_attendances.employee_id where employees.school_id=83 and employee_attendances.employee_id is null group by batch_tutors.employee_id;

question 9 :::select students.first_name,sum(finance_fees.balance) as total_balance,case when fine_rules.is_amount=1 then sum(fine_days*fine_amount)  when fine_rules.is_amount=0 then sum((fine_amount*balance*fine_days)/100) end as fine_amount ,fines.id from students left join finance_fees on students.id=finance_fees.student_id left join finance_fee_collections on finance_fees.fee_collection_id=finance_fee_collections.id left join fines on finance_fee_collections.fine_id=fines.id left join fine_rules on fines.id=fine_rules.fine_id where (finance_fees.is_paid=0 or finance_fees.is_fine_paid=0) and fines.is_deleted=0  and students.school_id=83 group by students.id;


question 10 :::select group_concat(distinct ffc.name) as collection_name,sum(ff.balance+ff.tax_amount+ff.particular_total - ff.discount_amount+ffp.amount-fd.discount+fine_amount) as actual_amount,fd.discount,case when fr.is_amount=1 then sum(fine_days*fine_amount)  when fr.is_amount=0 then sum((fine_amount*balance*fine_days)/100) end as fine_amount  from finance_fee_collections ffc inner join collection_discounts cd on ffc.id=cd.finance_fee_collection_id inner join collection_particulars cp on ffc.id=cp.finance_fee_collection_id inner join fines f on ffc.fine_id=f.id inner join finance_fees ff on ffc.id=ff.fee_collection_id left join fee_discounts fd on fd.id=cd.fee_discount_id left join finance_fee_particulars ffp on ffp.id=cp.finance_fee_particular_id left join fine_rules fr on f.id=fr.fine_id  where ff.school_id = 83 and ff.student_id = 4924 group by ff.student_id ;


